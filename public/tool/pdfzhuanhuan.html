<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFåœ¨çº¿è½¬æ¢ - å…¨èƒ½å·¥å…·ç®±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin: 30px 0;
            color: #2c3e50;
        }
        
        .intro {
            text-align: center;
            margin-bottom: 30px;
            color: #7f8c8d;
        }
        
        .converter-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .converter-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .converter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .converter-card h3 {
            color: #3498db;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .converter-card p {
            color: #7f8c8d;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }
        
        .tag {
            background: #e0f7fa;
            color: #00838f;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .file-input {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .convert-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
            width: 100%;
        }
        
        .convert-btn:hover {
            background: #2980b9;
        }
        
        .download-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
            width: 100%;
            margin-top: 10px;
            display: none;
        }
        
        .download-btn:hover {
            background: #27ae60;
        }
        
        .progress-container {
            width: 100%;
            background-color: #f1f1f1;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #4CAF50;
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s;
        }
        /* æ–‡ä»¶ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-area {
            width: 100%;
            height: 150px;
            border: 2px dashed #3498db;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer;
            margin-bottom: 15px;
            position: relative;
            transition: all 0.3s;
            background-color: rgba(52, 152, 219, 0.05);
        }

        .upload-area:hover {
            background-color: rgba(52, 152, 219, 0.1);
            border-color: #2980b9;
        }

        .upload-area.active {
            border-color: #2ecc71;
            background-color: rgba(46, 204, 113, 0.1);
        }

        .upload-icon {
            font-size: 2.5rem;
            color: #3498db;
            margin-bottom: 10px;
        }

        .upload-text {
            color: #7f8c8d;
            font-size: 1rem;
        }

        .upload-text strong {
            color: #3498db;
        }

        .upload-filename {
            margin-top: 10px;
            color: #2c3e50;
            font-size: 0.9rem;
            max-width: 90%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* è¿›åº¦æ¡æ ·å¼ */
        .upload-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background-color: #3498db;
            width: 0%;
            transition: width 0.3s;
            border-radius: 0 0 6px 6px;
        }

        /* éšè—åŸå§‹æ–‡ä»¶è¾“å…¥ */
        .file-input-hidden {
            display: none;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px 0;
            color: #7f8c8d;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            
            .converter-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>PDFåœ¨çº¿è½¬æ¢å·¥å…·</h1>
    <p class="intro">æ— éœ€ä¸Šä¼ æœåŠ¡å™¨ï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­å®ŒæˆPDFè½¬æ¢æ“ä½œï¼Œä¿æŠ¤æ‚¨çš„éšç§å®‰å…¨</p>
    
    <div class="converter-container">
        <!-- PDFè½¬Word -->
        <div class="converter-card">
            <h3>PDFè½¬Word</h3>
            <p>å°†PDFæ–‡æ¡£è½¬æ¢ä¸ºå¯ç¼–è¾‘çš„Wordæ ¼å¼</p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">docx</span>
                <span class="tag">è½¬æ¢</span>
            </div>
                <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfToWordUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfToWordFilename"></div>
                <div class="upload-progress" id="pdfToWordUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfToWordInput" accept=".pdf">
            <button class="convert-btn" id="pdfToWordBtn">å¼€å§‹è½¬æ¢</button>
            <button class="download-btn" id="pdfToWordDownload">ä¸‹è½½Wordæ–‡ä»¶</button>
            <div class="progress-container" id="pdfToWordProgress">
                <div class="progress-bar" id="pdfToWordProgressBar"></div>
            </div>
        </div>
        
        <!-- Wordè½¬PDF -->
        <div class="converter-card">
            <h3>Wordè½¬PDF</h3>
            <p>å°†Wordæ–‡æ¡£è½¬æ¢ä¸ºPDFæ ¼å¼</p>
            <div class="tags">
                <span class="tag">docx</span>
                <span class="tag">pdf</span>
                <span class="tag">è½¬æ¢</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="wordToPdfUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="wordToPdfFilename"></div>
                <div class="upload-progress" id="wordToPdfUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="wordToPdfInput" accept=".doc,.docx">
            <button class="convert-btn" id="wordToPdfBtn">å¼€å§‹è½¬æ¢</button>
            <button class="download-btn" id="wordToPdfDownload">ä¸‹è½½PDFæ–‡ä»¶</button>
            <div class="progress-container" id="wordToPdfProgress">
                <div class="progress-bar" id="wordToPdfProgressBar"></div>
            </div>
        </div>
        
        <!-- PDFè½¬å›¾ç‰‡ -->
        <div class="converter-card">
            <h3>PDFè½¬å›¾ç‰‡</h3>
            <p>å°†PDFæ–‡æ¡£è½¬æ¢ä¸ºå›¾ç‰‡(JPG/PNG)</p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">å›¾ç‰‡</span>
                <span class="tag">è½¬æ¢</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfToImageUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfToImageFilename"></div>
                <div class="upload-progress" id="pdfToImageUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfToImageInput" accept=".pdf">
            <select id="imageFormat" style="width:100%; margin-bottom:15px; padding:8px;">
                <option value="jpg">JPGæ ¼å¼</option>
                <option value="png">PNGæ ¼å¼</option>
            </select>
            <button class="convert-btn" id="pdfToImageBtn">å¼€å§‹è½¬æ¢</button>
            <div id="imagePreview" style="margin-top:15px;"></div>
        </div>
        
        <!-- å›¾ç‰‡è½¬PDF -->
        <div class="converter-card">
            <h3>å›¾ç‰‡è½¬PDF</h3>
            <p>å°†å¤šå¼ å›¾ç‰‡åˆå¹¶ä¸ºä¸€ä¸ªPDFæ–‡æ¡£</p>
            <div class="tags">
                <span class="tag">å›¾ç‰‡</span>
                <span class="tag">pdf</span>
                <span class="tag">åˆå¹¶</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="imageToPdfUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="imageToPdfFilename"></div>
                <div class="upload-progress" id="imageToPdfUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="imageToPdfInput" accept="image/*" multiple>
            <button class="convert-btn" id="imageToPdfBtn">å¼€å§‹è½¬æ¢</button>
            <button class="download-btn" id="imageToPdfDownload">ä¸‹è½½PDFæ–‡ä»¶</button>
            <div class="progress-container" id="imageToPdfProgress">
                <div class="progress-bar" id="imageToPdfProgressBar"></div>
            </div>
        </div>
        
        <!-- PDFåˆå¹¶ -->
        <div class="converter-card">
            <h3>PDFåˆå¹¶</h3>
            <p>å°†å¤šä¸ªPDFæ–‡æ¡£åˆå¹¶ä¸ºä¸€ä¸ª</p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">åˆå¹¶</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfMergeUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfMergeFilename"></div>
                <div class="upload-progress" id="pdfMergeUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfMergeInput" accept=".pdf" multiple>
            <button class="convert-btn" id="pdfMergeBtn">å¼€å§‹åˆå¹¶</button>
            <button class="download-btn" id="pdfMergeDownload">ä¸‹è½½åˆå¹¶æ–‡ä»¶</button>
            <div class="progress-container" id="pdfMergeProgress">
                <div class="progress-bar" id="pdfMergeProgressBar"></div>
            </div>
        </div>
        
        <!-- PDFæ‹†åˆ† -->
        <div class="converter-card">
            <h3>PDFæ‹†åˆ†</h3>
            <p>å°†ä¸€ä¸ªPDFæ–‡æ¡£æ‹†åˆ†ä¸ºå¤šä¸ª</p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">æ‹†åˆ†</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfSplitUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfSplitFilename"></div>
                <div class="upload-progress" id="pdfSplitUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfSplitInput" accept=".pdf">
            <div style="margin:10px 0;">
                <label for="splitRange">æ‹†åˆ†é¡µé¢èŒƒå›´(å¦‚1-3,5,7-9):</label>
                <input type="text" id="splitRange" style="width:100%; padding:8px;" placeholder="1-3,5,7-9">
            </div>
            <button class="convert-btn" id="pdfSplitBtn">å¼€å§‹æ‹†åˆ†</button>
            <div id="splitDownloads" style="margin-top:15px;"></div>
        </div>
        
        <!-- PDFå‹ç¼© -->
        <div class="converter-card">
            <h3>PDFå‹ç¼©</h3>
            <p>å‡å°PDFæ–‡ä»¶å¤§å°ï¼Œä¿æŒè´¨é‡</p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">å‹ç¼©</span>
                <span class="tag">ä¼˜åŒ–</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfCompressUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfCompressFilename"></div>
                <div class="upload-progress" id="pdfCompressUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfCompressInput" accept=".pdf">
            <select id="compressLevel" style="width:100%; margin-bottom:15px; padding:8px;">
                <option value="1">ä½å‹ç¼©(é«˜è´¨é‡)</option>
                <option value="2" selected>ä¸­ç­‰å‹ç¼©(å¹³è¡¡)</option>
                <option value="3">é«˜å‹ç¼©(å°æ–‡ä»¶)</option>
            </select>
            <button class="convert-btn" id="pdfCompressBtn">å¼€å§‹å‹ç¼©</button>
            <button class="download-btn" id="pdfCompressDownload">ä¸‹è½½å‹ç¼©æ–‡ä»¶</button>
            <div class="progress-container" id="pdfCompressProgress">
                <div class="progress-bar" id="pdfCompressProgressBar"></div>
            </div>
        </div>
        
        <!-- PDFåŠ å¯†/è§£å¯† -->
        <div class="converter-card">
            <h3>PDFåŠ å¯†/è§£å¯†</h3>
            <p>ä¸ºPDFæ·»åŠ å¯†ç ä¿æŠ¤æˆ–ç§»é™¤å¯†ç </p>
            <div class="tags">
                <span class="tag">pdf</span>
                <span class="tag">å®‰å…¨</span>
                <span class="tag">åŠ å¯†</span>
            </div>
            <!-- æ–°çš„ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="pdfSecurityUpload">
                <div class="upload-icon">ğŸ“„</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„<br><strong>æ”¯æŒPDFæ–‡ä»¶</strong></div>
                <div class="upload-filename" id="pdfSecurityFilename"></div>
                <div class="upload-progress" id="pdfSecurityUploadProgress"></div>
            </div>
            <input type="file" class="file-input" id="pdfSecurityInput" accept=".pdf">
            <select id="securityAction" style="width:100%; margin-bottom:15px; padding:8px;">
                <option value="encrypt">åŠ å¯†PDF</option>
                <option value="decrypt">è§£å¯†PDF(éœ€å¯†ç )</option>
            </select>
            <input type="password" id="pdfPassword" style="width:100%; padding:8px; margin-bottom:15px;" placeholder="è¾“å…¥å¯†ç ">
            <button class="convert-btn" id="pdfSecurityBtn">å¼€å§‹å¤„ç†</button>
            <button class="download-btn" id="pdfSecurityDownload">ä¸‹è½½å¤„ç†æ–‡ä»¶</button>
            <div class="progress-container" id="pdfSecurityProgress">
                <div class="progress-bar" id="pdfSecurityProgressBar"></div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>copyright Â© 2025 å…¨èƒ½å·¥å…·ç®± | ä¸ºæ‚¨æä¾›ä¾¿æ·çš„åœ¨çº¿å·¥å…·æœåŠ¡</p>
    </footer>

    <!-- å¼•å…¥å¿…è¦çš„JSåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.16.0/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js"></script>
    
    <script>
        // åˆå§‹åŒ–PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';
        // ä¸ºæ‰€æœ‰ä¸Šä¼ åŒºåŸŸæ·»åŠ æ‹–æ”¾åŠŸèƒ½
        function setupUploadArea(uploadAreaId, inputId, filenameId, progressId) {
            const uploadArea = document.getElementById(uploadAreaId);
            const fileInput = document.getElementById(inputId);
            const filenameDisplay = document.getElementById(filenameId);
            const progressBar = document.getElementById(progressId);
            
            // ç‚¹å‡»äº‹ä»¶
            uploadArea.addEventListener('click', () => fileInput.click());
            
            // æ‹–æ”¾äº‹ä»¶
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('active');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('active');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('active');
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    updateFilenameDisplay();
                }
            });
            
            // æ–‡ä»¶é€‰æ‹©å˜åŒ–äº‹ä»¶
            fileInput.addEventListener('change', updateFilenameDisplay);
            
            function updateFilenameDisplay() {
                if (fileInput.files.length) {
                    const file = fileInput.files[0];
                    filenameDisplay.textContent = file.name;
                    progressBar.style.width = '100%'; // é€‰æ‹©æ–‡ä»¶åç«‹å³æ˜¾ç¤ºå®Œæ•´è¿›åº¦æ¡
                } else {
                    filenameDisplay.textContent = '';
                    progressBar.style.width = '0%';
                }
            }
            
            // è¿”å›è¿›åº¦æ›´æ–°å‡½æ•°
            return function(progress) {
                progressBar.style.width = `${progress}%`;
            };
        }

        // åˆå§‹åŒ–æ‰€æœ‰ä¸Šä¼ åŒºåŸŸ
        const updatePdfToWordProgress = setupUploadArea(
            'pdfToWordUpload', 
            'pdfToWordInput', 
            'pdfToWordFilename', 
            'pdfToWordUploadProgress'
        );

        const updateWordToPdfProgress = setupUploadArea(
            'wordToPdfUpload', 
            'wordToPdfInput', 
            'wordToPdfFilename', 
            'wordToPdfUploadProgress'
        );

        const updatePdfToImageProgress = setupUploadArea(
            'pdfToImageUpload', 
            'pdfToImageInput', 
            'pdfToImageFilename', 
            'pdfToImageUploadProgress'
        );


        const updatePdfMergeProgress = setupUploadArea(
            'pdfMergeUpload', 
            'pdfMergeInput', 
            'pdfMergeFilename', 
            'pdfMergeUploadProgress'
        );

        const updatePdfSplitProgress = setupUploadArea(
            'pdfSplitUpload', 
            'pdfSplitInput', 
            'pdfSplitFilename', 
            'pdfSplitUploadProgress'
        );
        const updatePdfCompressProgress = setupUploadArea(
            'pdfCompressUpload', 
            'pdfCompressInput', 
            'pdfCompressFilename', 
            'pdfCompressUploadProgress'
        );

        const updatePdfSecurityProgress = setupUploadArea(
            'pdfSecurityUpload', 
            'pdfSecurityInput', 
            'pdfSecurityFilename', 
            'pdfSecurityUploadProgress'
        );
        // å…¶ä»–è½¬æ¢å™¨çš„ä¸Šä¼ åŒºåŸŸä¹Ÿéœ€è¦ç±»ä¼¼åˆå§‹åŒ–...
        // åˆå§‹åŒ–å›¾ç‰‡è½¬PDFä¸Šä¼ åŒºåŸŸ(æ”¯æŒå¤šæ–‡ä»¶)
        function setupMultiFileUpload(uploadAreaId, inputId, filenameId, progressId) {
            const uploadArea = document.getElementById(uploadAreaId);
            const fileInput = document.getElementById(inputId);
            const filenameDisplay = document.getElementById(filenameId);
            const progressBar = document.getElementById(progressId);
            
            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('active');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('active');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('active');
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    updateFilenameDisplay();
                }
            });
            
            fileInput.addEventListener('change', updateFilenameDisplay);
            
            function updateFilenameDisplay() {
                if (fileInput.files.length) {
                    const files = fileInput.files;
                    if (files.length === 1) {
                        filenameDisplay.textContent = files[0].name;
                    } else {
                        filenameDisplay.textContent = `${files.length}ä¸ªæ–‡ä»¶å·²é€‰æ‹©`;
                    }
                    progressBar.style.width = '100%';
                } else {
                    filenameDisplay.textContent = '';
                    progressBar.style.width = '0%';
                }
            }
            
            return function(progress) {
                progressBar.style.width = `${progress}%`;
            };
        }

        // åˆå§‹åŒ–å¤šæ–‡ä»¶ä¸Šä¼ åŒºåŸŸ(å¦‚å›¾ç‰‡è½¬PDF)
        const updateImageToPdfProgress = setupMultiFileUpload(
            'imageToPdfUpload',
            'imageToPdfInput',
            'imageToPdfFilename',
            'imageToPdfUploadProgress'
        );
        // PDFè½¬Word
        document.getElementById('pdfToWordBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfToWordInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            const file = fileInput.files[0];
            const progress = document.getElementById('pdfToWordProgress');
            const progressBar = document.getElementById('pdfToWordProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                // è¿™é‡Œåº”è¯¥æœ‰å®é™…çš„PDFè½¬Wordé€»è¾‘
                // ç”±äºçº¯å‰ç«¯PDFè½¬Wordæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿ
                progressBar.style.width = '30%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '60%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '100%';
                
                // æ¨¡æ‹Ÿç”ŸæˆWordæ–‡ä»¶
                const { Document, Paragraph, Packer } = docx;
                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: [
                            new Paragraph({
                                text: "è¿™æ˜¯ä»PDFè½¬æ¢è€Œæ¥çš„Wordæ–‡æ¡£",
                                heading: "Heading1"
                            }),
                            new Paragraph({
                                text: "ç”±äºçº¯å‰ç«¯PDFè½¬Wordæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯æ¼”ç¤º",
                                heading: "Heading2"
                            })
                        ]
                    }]
                });
                
                const blob = await Packer.toBlob(doc);
                const downloadBtn = document.getElementById('pdfToWordDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(blob, 'converted.docx');
                };
                
            } catch (error) {
                console.error(error);
                alert('è½¬æ¢å¤±è´¥: ' + error.message);
            }
        });
        
        // Wordè½¬PDF
        document.getElementById('wordToPdfBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('wordToPdfInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©Wordæ–‡ä»¶');
                return;
            }
            
            const file = fileInput.files[0];
            const progress = document.getElementById('wordToPdfProgress');
            const progressBar = document.getElementById('wordToPdfProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                // è¿™é‡Œåº”è¯¥æœ‰å®é™…çš„Wordè½¬PDFé€»è¾‘
                // ç”±äºçº¯å‰ç«¯Wordè½¬PDFæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿ
                progressBar.style.width = '30%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '60%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '100%';
                
                // æ¨¡æ‹Ÿç”ŸæˆPDFæ–‡ä»¶
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.text('è¿™æ˜¯ä»Wordè½¬æ¢è€Œæ¥çš„PDFæ–‡æ¡£', 10, 10);
                doc.text('ç”±äºçº¯å‰ç«¯Wordè½¬PDFæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯æ¼”ç¤º', 10, 20);
                
                const pdfBlob = doc.output('blob');
                const downloadBtn = document.getElementById('wordToPdfDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(pdfBlob, 'converted.pdf');
                };
                
            } catch (error) {
                console.error(error);
                alert('è½¬æ¢å¤±è´¥: ' + error.message);
            }
        });
        
        // PDFè½¬å›¾ç‰‡
        document.getElementById('pdfToImageBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfToImageInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            const file = fileInput.files[0];
            const format = document.getElementById('imageFormat').value;
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<p>æ­£åœ¨è½¬æ¢...</p>';
            
            try {
                const arrayBuffer = await file.arrayBuffer();
                const loadingTask = pdfjsLib.getDocument(arrayBuffer);
                const pdf = await loadingTask.promise;
                
                preview.innerHTML = '';
                
                // è½¬æ¢æ¯ä¸€é¡µä¸ºå›¾ç‰‡
                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const viewport = page.getViewport({ scale: 1.5 });
                    
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    
                    await page.render({
                        canvasContext: context,
                        viewport: viewport
                    }).promise;
                    
                    const imgData = canvas.toDataURL(`image/${format}`);
                    const img = document.createElement('img');
                    img.src = imgData;
                    img.style.maxWidth = '100%';
                    img.style.marginBottom = '10px';
                    img.style.display = 'block';
                    
                    const downloadLink = document.createElement('a');
                    downloadLink.href = imgData;
                    downloadLink.download = `page_${i}.${format}`;
                    downloadLink.textContent = `ä¸‹è½½ç¬¬${i}é¡µ`;
                    downloadLink.style.display = 'block';
                    downloadLink.style.marginBottom = '20px';
                    downloadLink.style.color = '#3498db';
                    
                    const container = document.createElement('div');
                    container.appendChild(img);
                    container.appendChild(downloadLink);
                    preview.appendChild(container);
                }
                
            } catch (error) {
                console.error(error);
                preview.innerHTML = '<p style="color:red;">è½¬æ¢å¤±è´¥: ' + error.message + '</p>';
            }
        });
        
        // å›¾ç‰‡è½¬PDF
        document.getElementById('imageToPdfBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('imageToPdfInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }
            
            const files = Array.from(fileInput.files);
            const progress = document.getElementById('imageToPdfProgress');
            const progressBar = document.getElementById('imageToPdfProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const img = await createImageBitmap(file);
                    
                    if (i > 0) doc.addPage();
                    
                    const imgWidth = doc.internal.pageSize.getWidth() - 20;
                    const imgHeight = (img.height * imgWidth) / img.width;
                    
                    doc.addImage(img, 'JPEG', 10, 10, imgWidth, imgHeight);
                    
                    progressBar.style.width = `${((i + 1) / files.length) * 100}%`;
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                const pdfBlob = doc.output('blob');
                const downloadBtn = document.getElementById('imageToPdfDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(pdfBlob, 'converted.pdf');
                };
                
            } catch (error) {
                console.error(error);
                alert('è½¬æ¢å¤±è´¥: ' + error.message);
            }
        });
        
        // PDFåˆå¹¶
        document.getElementById('pdfMergeBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfMergeInput');
            if (!fileInput.files.length || fileInput.files.length < 2) {
                alert('è¯·è‡³å°‘é€‰æ‹©2ä¸ªPDFæ–‡ä»¶');
                return;
            }
            
            const files = Array.from(fileInput.files);
            const progress = document.getElementById('pdfMergeProgress');
            const progressBar = document.getElementById('pdfMergeProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                const { PDFDocument } = PDFLib;
                const mergedPdf = await PDFDocument.create();
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const arrayBuffer = await file.arrayBuffer();
                    const pdfDoc = await PDFDocument.load(arrayBuffer);
                    
                    const pages = await mergedPdf.copyPages(pdfDoc, pdfDoc.getPageIndices());
                    pages.forEach(page => mergedPdf.addPage(page));
                    
                    progressBar.style.width = `${((i + 1) / files.length) * 100}%`;
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                const mergedPdfBytes = await mergedPdf.save();
                const mergedPdfBlob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                
                const downloadBtn = document.getElementById('pdfMergeDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(mergedPdfBlob, 'merged.pdf');
                };
                
            } catch (error) {
                console.error(error);
                alert('åˆå¹¶å¤±è´¥: ' + error.message);
            }
        });
        
        // PDFæ‹†åˆ†
        document.getElementById('pdfSplitBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfSplitInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            const rangeText = document.getElementById('splitRange').value.trim();
            if (!rangeText) {
                alert('è¯·è¾“å…¥è¦æ‹†åˆ†çš„é¡µé¢èŒƒå›´');
                return;
            }
            
            const file = fileInput.files[0];
            const downloadsContainer = document.getElementById('splitDownloads');
            downloadsContainer.innerHTML = '<p>æ­£åœ¨å¤„ç†...</p>';
            
            try {
                const arrayBuffer = await file.arrayBuffer();
                const { PDFDocument } = PDFLib;
                const pdfDoc = await PDFDocument.load(arrayBuffer);
                const pageCount = pdfDoc.getPageCount();
                
                // è§£æé¡µé¢èŒƒå›´
                const ranges = rangeText.split(',');
                const pageSets = [];
                
                for (const range of ranges) {
                    if (range.includes('-')) {
                        const [start, end] = range.split('-').map(Number);
                        for (let i = start; i <= end; i++) {
                            if (i >= 1 && i <= pageCount) {
                                pageSets.push([i]);
                            }
                        }
                    } else {
                        const pageNum = Number(range);
                        if (pageNum >= 1 && pageNum <= pageCount) {
                            pageSets.push([pageNum]);
                        }
                    }
                }
                
                if (pageSets.length === 0) {
                    alert('æ²¡æœ‰æœ‰æ•ˆçš„é¡µé¢èŒƒå›´');
                    return;
                }
                
                downloadsContainer.innerHTML = '';
                
                for (const pages of pageSets) {
                    const newPdf = await PDFDocument.create();
                    const copiedPages = await newPdf.copyPages(pdfDoc, pages.map(p => p - 1));
                    copiedPages.forEach(page => newPdf.addPage(page));
                    
                    const pdfBytes = await newPdf.save();
                    const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
                    
                    const downloadLink = document.createElement('a');
                    downloadLink.href = URL.createObjectURL(pdfBlob);
                    downloadLink.download = `page_${pages.join('_')}.pdf`;
                    downloadLink.textContent = `ä¸‹è½½é¡µé¢ ${pages.join(', ')}`;
                    downloadLink.style.display = 'block';
                    downloadLink.style.marginBottom = '10px';
                    downloadLink.style.color = '#3498db';
                    
                    downloadsContainer.appendChild(downloadLink);
                }
                
            } catch (error) {
                console.error(error);
                downloadsContainer.innerHTML = '<p style="color:red;">æ‹†åˆ†å¤±è´¥: ' + error.message + '</p>';
            }
        });
        
        // PDFå‹ç¼©
        document.getElementById('pdfCompressBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfCompressInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            const file = fileInput.files[0];
            const level = document.getElementById('compressLevel').value;
            const progress = document.getElementById('pdfCompressProgress');
            const progressBar = document.getElementById('pdfCompressProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                // æ¨¡æ‹Ÿå‹ç¼©è¿‡ç¨‹
                progressBar.style.width = '30%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '60%';
                await new Promise(resolve => setTimeout(resolve, 500));
                progressBar.style.width = '100%';
                
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥æœ‰å®é™…çš„PDFå‹ç¼©é€»è¾‘
                // ç”±äºçº¯å‰ç«¯PDFå‹ç¼©æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿ
                const arrayBuffer = await file.arrayBuffer();
                const { PDFDocument } = PDFLib;
                const pdfDoc = await PDFDocument.load(arrayBuffer);
                
                // æ¨¡æ‹Ÿä¸åŒå‹ç¼©çº§åˆ«
                let saveOptions = {};
                if (level === '1') {
                    saveOptions = { useObjectStreams: false };
                } else if (level === '3') {
                    saveOptions = { useObjectStreams: true, compressImages: true, imageQuality: 0.5 };
                } else {
                    saveOptions = { useObjectStreams: true, compressImages: true, imageQuality: 0.75 };
                }
                
                const pdfBytes = await pdfDoc.save(saveOptions);
                const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
                
                const downloadBtn = document.getElementById('pdfCompressDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(pdfBlob, 'compressed.pdf');
                };
                
            } catch (error) {
                console.error(error);
                alert('å‹ç¼©å¤±è´¥: ' + error.message);
            }
        });
        
        // PDFåŠ å¯†/è§£å¯†
        document.getElementById('pdfSecurityBtn').addEventListener('click', async function() {
            const fileInput = document.getElementById('pdfSecurityInput');
            if (!fileInput.files.length) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            const action = document.getElementById('securityAction').value;
            const password = document.getElementById('pdfPassword').value;
            
            if (action === 'encrypt' && !password) {
                alert('è¯·è®¾ç½®å¯†ç ');
                return;
            }
            
            const file = fileInput.files[0];
            const progress = document.getElementById('pdfSecurityProgress');
            const progressBar = document.getElementById('pdfSecurityProgressBar');
            
            progress.style.display = 'block';
            progressBar.style.width = '0%';
            
            try {
                const arrayBuffer = await file.arrayBuffer();
                const { PDFDocument } = PDFLib;
                const pdfDoc = await PDFDocument.load(arrayBuffer);
                
                progressBar.style.width = '50%';
                
                if (action === 'encrypt') {
                    // åŠ å¯†PDF
                    pdfDoc.setUserPassword(password);
                    pdfDoc.setUserAccessPermissions([PDFDocument.UserAccessPermissions.Printing]);
                } else {
                    // è§£å¯†PDF
                    try {
                        await pdfDoc.setUserPassword(password);
                    } catch (error) {
                        if (error.message.includes('Incorrect password')) {
                            throw new Error('å¯†ç ä¸æ­£ç¡®');
                        }
                        throw error;
                    }
                }
                
                progressBar.style.width = '100%';
                const pdfBytes = await pdfDoc.save();
                const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
                
                const downloadBtn = document.getElementById('pdfSecurityDownload');
                downloadBtn.style.display = 'block';
                downloadBtn.onclick = function() {
                    saveAs(pdfBlob, action === 'encrypt' ? 'encrypted.pdf' : 'decrypted.pdf');
                };
                
            } catch (error) {
                console.error(error);
                alert('å¤„ç†å¤±è´¥: ' + error.message);
            }
        });
    </script>
</body>
</html>