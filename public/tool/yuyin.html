<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" type="image/png"
        href="https://static.bcmcdn.com/coco/player/unstable/r158rJpByx.image/jpeg?hash=FtXSHESVlIdg5bOCixyXyh3J65So">

    <meta name="apple-mobile-web-app-title" content="CodePen">

    <link rel="shortcut icon" type="image/x-icon"
        href="https://static.bcmcdn.com/coco/player/unstable/r158rJpByx.image/jpeg?hash=FtXSHESVlIdg5bOCixyXyh3J65So">

    <link rel="mask-icon" type="image/x-icon"
        href="https://static.bcmcdn.com/coco/player/unstable/r158rJpByx.image/jpeg?hash=FtXSHESVlIdg5bOCixyXyh3J65So"
        color="#111">
    <title>æ–‡å­—è½¬è¯­éŸ³ - å…¨èƒ½å·¥å…·ç®±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin: 30px 0;
            color: #2c3e50;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .tool-icon {
            font-size: 2rem;
            margin-right: 15px;
        }
        
        .intro {
            text-align: center;
            margin-bottom: 30px;
            color: #7f8c8d;
        }
        
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .tag {
            background: #e0f7fa;
            color: #00838f;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .voice-select {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background: white;
        }
        
        .range-control {
            flex: 1;
            min-width: 200px;
        }
        
        .range-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .range-input {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: #ddd;
            border-radius: 4px;
            outline: none;
        }
        
        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #3498db;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #bdbdbd;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .status {
            text-align: center;
            margin-bottom: 30px;
            padding: 10px;
            border-radius: 4px;
            background: #f8f9fa;
            color: #7f8c8d;
        }
        
        .audio-player {
            width: 100%;
            margin-bottom: 30px;
            display: none;
        }
        
        .char-count {
            text-align: right;
            margin-bottom: 10px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px 0;
            color: #7f8c8d;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <h1><span class="tool-icon">ğŸ”¤</span>æ–‡å­—è½¬è¯­éŸ³</h1>
    <p class="intro">å°†è¾“å…¥çš„æ–‡å­—è½¬æ¢ä¸ºè‡ªç„¶è¯­éŸ³è¾“å‡ºï¼Œæ”¯æŒå¤šç§è¯­éŸ³å’Œè°ƒèŠ‚å‚æ•°</p>
    
    <div class="tags">
        <span class="tag">æ–‡å­—</span>
        <span class="tag">è¯­éŸ³</span>
        <span class="tag">TTS</span>
    </div>
    
    <div class="char-count" id="charCount">0/5000 å­—</div>
    <textarea id="textInput" placeholder="è¯·è¾“å…¥è¦è½¬æ¢ä¸ºè¯­éŸ³çš„æ–‡å­—å†…å®¹ï¼Œæœ€å¤šæ”¯æŒ5000å­—..."></textarea>
    
    <div class="controls">
        <select id="voiceSelect" class="voice-select">
            <option value="">åŠ è½½è¯­éŸ³ä¸­...</option>
        </select>
        
        <div class="range-control">
            <div class="range-label">
                <span>è¯­é€Ÿ</span>
                <span id="rateValue">1.0</span>
            </div>
            <input type="range" id="rateInput" class="range-input" min="0.5" max="2" step="0.1" value="1">
        </div>
        
        <div class="range-control">
            <div class="range-label">
                <span>éŸ³è°ƒ</span>
                <span id="pitchValue">1.0</span>
            </div>
            <input type="range" id="pitchInput" class="range-input" min="0.5" max="2" step="0.1" value="1">
        </div>
    </div>
    
    <div class="buttons">
        <button id="playBtn" class="btn btn-primary" disabled>
            <span>â–¶</span> æ’­æ”¾
        </button>
        <button id="pauseBtn" class="btn btn-secondary" disabled>
            <span>â¸</span> æš‚åœ
        </button>
        <button id="resumeBtn" class="btn btn-primary" disabled>
            <span>âµ</span> ç»§ç»­
        </button>
        <button id="stopBtn" class="btn btn-danger" disabled>
            <span>â¹</span> åœæ­¢
        </button>
    </div>
    
    <div class="status" id="statusInfo">å‡†å¤‡å°±ç»ª</div>
    
    <audio id="audioPlayer" class="audio-player" controls></audio>
    
    <footer>
        <p>copyright Â© 2025 å…¨èƒ½å·¥å…·ç®± | ä¸ºæ‚¨æä¾›ä¾¿æ·çš„åœ¨çº¿å·¥å…·æœåŠ¡</p>
    </footer>

    <script>
        // è·å–DOMå…ƒç´ 
        const textInput = document.getElementById('textInput');
        const charCount = document.getElementById('charCount');
        const voiceSelect = document.getElementById('voiceSelect');
        const rateInput = document.getElementById('rateInput');
        const rateValue = document.getElementById('rateValue');
        const pitchInput = document.getElementById('pitchInput');
        const pitchValue = document.getElementById('pitchValue');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const stopBtn = document.getElementById('stopBtn');
        const statusInfo = document.getElementById('statusInfo');
        const audioPlayer = document.getElementById('audioPlayer');
        
        // è¯­éŸ³åˆæˆå¯¹è±¡
        const synth = window.speechSynthesis;
        let voices = [];
        let utterance = null;
        let audioChunks = [];
        let mediaRecorder = null;
        
        // åˆå§‹åŒ–è¯­éŸ³åˆ—è¡¨
        function loadVoices() {
            voices = synth.getVoices();
            voiceSelect.innerHTML = '';
            
            // ç­›é€‰ä¸­æ–‡è¯­éŸ³
            const chineseVoices = voices.filter(voice => 
                voice.lang.includes('zh') || voice.lang.includes('cmn'));
            
            if (chineseVoices.length > 0) {
                chineseVoices.forEach(voice => {
                    const option = document.createElement('option');
                    option.textContent = `${voice.name} (${voice.lang})`;
                    option.setAttribute('data-name', voice.name);
                    voiceSelect.appendChild(option);
                });
                
                // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªä¸­æ–‡è¯­éŸ³
                voiceSelect.selectedIndex = 0;
                updateButtonStates();
            } else {
                const option = document.createElement('option');
                option.textContent = 'æœªæ‰¾åˆ°ä¸­æ–‡è¯­éŸ³';
                voiceSelect.appendChild(option);
                statusInfo.textContent = 'è­¦å‘Šï¼šæ‚¨çš„æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒä¸­æ–‡è¯­éŸ³';
            }
        }
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        function updateButtonStates() {
            const hasText = textInput.value.trim().length > 0;
            const isSpeaking = synth.speaking;
            const isPaused = synth.paused;
            
            playBtn.disabled = !hasText || isSpeaking;
            pauseBtn.disabled = !isSpeaking || isPaused;
            resumeBtn.disabled = !isPaused;
            stopBtn.disabled = !isSpeaking && !isPaused;
        }
        
        // æ›´æ–°çŠ¶æ€ä¿¡æ¯
        function updateStatus(message) {
            statusInfo.textContent = message;
        }
        
        // æ’­æ”¾è¯­éŸ³
        function playSpeech() {
            if (synth.speaking) {
                synth.cancel();
            }
            
            const text = textInput.value.trim();
            if (!text) return;
            
            const selectedVoiceName = voiceSelect.selectedOptions[0].getAttribute('data-name');
            const selectedVoice = voices.find(voice => voice.name === selectedVoiceName);
            const rate = parseFloat(rateInput.value);
            const pitch = parseFloat(pitchInput.value);
            
            utterance = new SpeechSynthesisUtterance(text);
            
            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }
            
            utterance.rate = rate;
            utterance.pitch = pitch;
            
            utterance.onstart = () => {
                updateStatus('æ­£åœ¨æ’­æ”¾...');
                updateButtonStates();
            };
            
            utterance.onend = () => {
                updateStatus('æ’­æ”¾å®Œæˆ');
                updateButtonStates();
            };
            
            utterance.onerror = (event) => {
                updateStatus(`é”™è¯¯: ${event.error}`);
                updateButtonStates();
            };
            
            synth.speak(utterance);
            updateButtonStates();
        }
        
        // æš‚åœè¯­éŸ³
        function pauseSpeech() {
            if (synth.speaking) {
                synth.pause();
                updateStatus('å·²æš‚åœ');
                updateButtonStates();
            }
        }
        
        // ç»§ç»­è¯­éŸ³
        function resumeSpeech() {
            if (synth.paused) {
                synth.resume();
                updateStatus('ç»§ç»­æ’­æ”¾...');
                updateButtonStates();
            }
        }
        
        // åœæ­¢è¯­éŸ³
        function stopSpeech() {
            synth.cancel();
            updateStatus('å·²åœæ­¢');
            updateButtonStates();
        }
        
        // æ›´æ–°å­—ç¬¦è®¡æ•°
        function updateCharCount() {
            const count = textInput.value.length;
            charCount.textContent = `${count}/5000 å­—`;
            
            if (count > 5000) {
                charCount.style.color = '#e74c3c';
            } else {
                charCount.style.color = '#7f8c8d';
            }
            
            updateButtonStates();
        }
        
        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
        function initEventListeners() {
            // è¯­éŸ³åŠ è½½
            synth.onvoiceschanged = loadVoices;
            
            // è¾“å…¥å˜åŒ–
            textInput.addEventListener('input', updateCharCount);
            
            // æ§åˆ¶æŒ‰é’®
            playBtn.addEventListener('click', playSpeech);
            pauseBtn.addEventListener('click', pauseSpeech);
            resumeBtn.addEventListener('click', resumeSpeech);
            stopBtn.addEventListener('click', stopSpeech);
            
            // è¯­é€Ÿå’ŒéŸ³è°ƒè°ƒèŠ‚
            rateInput.addEventListener('input', () => {
                rateValue.textContent = rateInput.value;
            });
            
            pitchInput.addEventListener('input', () => {
                pitchValue.textContent = pitchInput.value;
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', () => {
            initEventListeners();
            loadVoices();
            updateCharCount();
            updateButtonStates();
        });
    </script>
</body>
</html>